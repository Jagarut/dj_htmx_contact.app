{% extends 'layout.html' %}

{% block body %}
    <div class="flex items-center">
        {% if query %}
            <h1 class="mt-4 mb-6 text-2xl leading-none font-bold tracking-tight md:text-3xl lg:text-4xl">Search results</h1>
        {% else %}
            <h1 class="mt-4 mb-6 text-2xl leading-none font-bold tracking-tight md:text-3xl lg:text-4xl">Contact List</h1>
        {% endif %}
    </div>
    <div class="border mb-6"></div>
    {% if messages %}
    <div>
        {% for message in messages %}
            <div class="alert {% if message.tags %}alert-{{ message.tags }}{% endif %}">
                {{ message }}
            </div>
        {% endfor %}
    </div>
    {% endif %}
    {% if not query %}
      
    <div class="mx-5">
        <form action="/contacts" method="get">
            <label for="search" class="block text-sm font-medium leading-6 text-gray-900">Search Term</label>
            <input id="search" type="text" name="search" class="input input-bordered w-full max-w-xs"/>
            <input type="submit" value="Search" class="btn"/>
        </form>
    </div>
    <div>
        <a href="{% url 'new-contact' %}" class="btn btn-lg mx-5 my-4 py-4"> Add Contact</a>
    </div>
    {% endif %}

    <br>
    <div class="overflow-x-auto">
    <table class="table">
      <thead>
        <tr>
            <th>First Name</th>
            <th>Last Name</th>
            <th>Phone</th>
            <th>Email</th>
            <th></th>
        </tr>
      </thead>
      <tbody>
            {% for contact in contacts %}
            <tr>
                <th>{{ contact.first_name }}</th>
                <th>{{ contact.last_name}}</th>
                <th>{{ contact.phone}}</th>
                <th>{{ contact.email}}</th>
                <th>
                    <a href="{% url 'edit' contact.pk %}" class="text-green-500 bg-white border-2 border-green-500 rounded px-2 py-1 text-sm hover:bg-gray-200 hover:text-gray-800">Edit</a>
                    <a href="{% url 'view' contact.pk %}" class="text-green-500 bg-white border-2 border-green-500 rounded px-2 py-1 text-sm hover:bg-gray-200 hover:text-gray-800">View</a>
                </th>
                <th>
                    <button 
                        hx-delete="{% url 'delete' contact.pk %}" 
                        hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'
                        hx-push-url="true"
                        hx-target="body"
                        hx-confirm="Are you sure you want to delete this contact?"
                        class="text-white bg-red-500 border-2 border-red-500 rounded px-2 py-1 text-sm hover:bg-gray-200 hover:text-gray-800">
                        Delete
                    </button>
                </th>                
            </tr>
            {% endfor %}
        </tbody>   
    </table>
    {% if query %}
        <br>
        <a href="{% url 'index' %}" class="text-blue-700 underline">Back to contact list</a>
    {% endif %}
</div>

{% endblock body %}